<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<!--          Orator: Copyright 2000-2009 The Horde Project.            -->
<!-- Horde Project: https://horde.org/ | Orator: https://horde.org/orator/ -->
<!--          Horde Licenses: http://www.horde.org/licenses/             -->
<html><head>
<title>Presentations</title>
<link href="favicon.ico" rel="SHORTCUT ICON" />
<link href="screen.css" rel="stylesheet" type="text/css" />
</head>

<body>
<table class="oratorHeader" border="0" cellspacing="0" cellpadding="1" width="100%"><tr>
<td width="1%" align="left" class="oratorHeaderBack" valign="center" nowrap="nowrap"><a href="45_step4j.xml.html" onmouseout="window.status='';" onmouseover="window.status='Go to: Forms'; return true;" accesskey="P"><img src="presentation_back.png" alt="Back" title="Back" /></a></td><td style="cursor: hand;" onclick="location.href='45_step4j.xml.html';" align="left" class="oratorHeaderBack" width="24%"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class="oratorTitleHigh">Forms</div></td></tr></table></td>
<td width="50%" align="center" style="cursor: hand;" class="oratorHeaderBack" valign="center" nowrap="nowrap" onclick="if (document.getElementById('title').style.display=='none'){document.getElementById('slides').style.display='none';document.getElementById('title').style.display='inline';}else{document.getElementById('title').style.display='none';document.getElementById('slides').style.display='inline';}" ondblclick="location.href='46_step4k.xml.html';"><select id="slides" style="display:none" onchange="location.href=this.options[this.selectedIndex].value"><option value="0_title.xml.html">Welcome</option><option value="1_horde1a.xml.html">What is Horde?</option><option value="2_horde1b.xml.html">What is Horde?</option><option value="3_horde1c.xml.html">What is Horde?</option><option value="4_horde1d.xml.html">What is Horde?</option><option value="5_horde1e.xml.html">What is Horde?</option><option value="6_history1.xml.html">History</option><option value="7_history2.xml.html">History</option><option value="8_history3.xml.html">History</option><option value="9_history4.xml.html">History</option><option value="10_horde2a.xml.html">Numbers and Buzz Words</option><option value="11_horde2b.xml.html">Numbers and Buzz Words</option><option value="12_horde2c.xml.html">Numbers and Buzz Words</option><option value="13_horde2d.xml.html">Numbers and Buzz Words</option><option value="14_horde2e.xml.html">Numbers and Buzz Words</option><option value="15_horde2f.xml.html">Numbers and Buzz Words</option><option value="16_horde2g.xml.html">Numbers and Buzz Words</option><option value="17_goal1.xml.html">Today's Goal</option><option value="18_goal2.xml.html">Today's Goal</option><option value="19_goal3.xml.html">Today's Goal</option><option value="20_skeleton.xml.html">Application structure</option><option value="21_step1a.xml.html">Creating the Skeleton</option><option value="22_step1b.xml.html">Creating the Skeleton</option><option value="23_step1c.xml.html">Creating the Skeleton</option><option value="24_step1d.xml.html">Creating the Skeleton</option><option value="25_step1e.xml.html">Creating the Skeleton</option><option value="26_step1f.xml.html">Creating the Skeleton</option><option value="27_step1g.xml.html">Creating the Skeleton</option><option value="28_step1h.xml.html">Creating the Skeleton</option><option value="29_step2a.xml.html">Database Structure</option><option value="30_step2b.xml.html">Database Structure</option><option value="31_step2c.xml.html">Database Structure</option><option value="32_step2d.xml.html">Database Structure</option><option value="33_step3a.xml.html">Database Access</option><option value="34_step3b.xml.html">Database Access</option><option value="35_step3c.xml.html">Database Access</option><option value="36_step4a.xml.html">Forms</option><option value="37_step4b.xml.html">Forms</option><option value="38_step4c.xml.html">Forms</option><option value="39_step4d.xml.html">Forms</option><option value="40_step4e.xml.html">Forms</option><option value="41_step4f.xml.html">Forms</option><option value="42_step4g.xml.html">Forms</option><option value="43_step4h.xml.html">Forms</option><option value="44_step4i.xml.html">Forms</option><option value="45_step4j.xml.html">Forms</option><option value="46_step4k.xml.html" selected="selected">Forms</option><option value="47_step5a.xml.html">Templates</option><option value="48_step5b.xml.html">Templates</option><option value="49_step6a.xml.html">Forms II</option><option value="50_step6b.xml.html">Forms II</option><option value="51_step6c.xml.html">Forms II</option><option value="52_step6d.xml.html">Forms II</option><option value="53_step7a.xml.html">VFS</option><option value="54_step7b.xml.html">VFS</option><option value="55_step7c.xml.html">VFS</option><option value="56_step7d.xml.html">VFS</option><option value="57_step7e.xml.html">VFS</option><option value="58_step7f.xml.html">VFS</option><option value="59_step7g.xml.html">VFS</option><option value="60_author.xml.html">Credits</option><option value="61_todo.xml.html">Outlook</option><option value="62_resources.xml.html">Resources</option><option value="63_questions.xml.html">Questions</option><option value="64_thanks.xml.html">Thank You</option></select><span id="title"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class="oratorTitle">Forms</div></td></tr></table></span></td>
<td style="cursor: hand;" onclick="location.href='47_step5a.xml.html';"width="24%" align="right" class="oratorHeaderBack" valign="center" nowrap="nowrap"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap"><div class="oratorTitleHigh">Templates</div></td></tr></table></td><td width="1%" align="right"><a href="47_step5a.xml.html" onmouseout="window.status='';" onmouseover="window.status='Go to: Templates'; return true;" accesskey="N"><img src="presentation_forward.png" alt="Forward" title="Forward" /></a></td>
</tr></table>
<br /><br /><div align="center">
<table border="0" width="90%"><tr><td align="left">

  <div align="center" class="osHeading">Step 4: Creating a Form</div>

  <p>Form rendering and validation:</p>

  <code><font color="#000000">
<br /><font color="#0000BB">&lt;?php<br /><br /></font><font color="#FF8000">/* Load libraries. */<br /></font><font color="#007700">require_once </font><font color="#0000BB">MOPPLE_BASE </font><font color="#007700">. </font><font color="#DD0000">'/lib/base.php'</font><font color="#007700">;<br />require_once </font><font color="#0000BB">MOPPLE_BASE </font><font color="#007700">. </font><font color="#DD0000">'/lib/MP3Form.php'</font><font color="#007700">;<br />require_once </font><font color="#DD0000">'Horde/Variables.php'</font><font color="#007700">;<br /><br /></font><font color="#FF8000">/* Initialize variables. */<br /></font><font color="#0000BB">$variables </font><font color="#007700">= &amp;</font><font color="#0000BB">Variables</font><font color="#007700">::</font><font color="#0000BB">getDefaultVariables</font><font color="#007700">();<br /></font><font color="#0000BB">$id </font><font color="#007700">= </font><font color="#0000BB">$variables</font><font color="#007700">-&gt;</font><font color="#0000BB">get</font><font color="#007700">(</font><font color="#DD0000">'id'</font><font color="#007700">);<br /></font><font color="#0000BB">$edit </font><font color="#007700">= !empty(</font><font color="#0000BB">$id</font><font color="#007700">);<br /></font><font color="#0000BB">$title </font><font color="#007700">= </font><font color="#0000BB">$edit </font><font color="#007700">? </font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Edit MP3"</font><font color="#007700">) : </font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"Add MP3"</font><font color="#007700">);<br /><br /></font><font color="#FF8000">/* Create form instance. */<br /></font><font color="#0000BB">$form </font><font color="#007700">= &amp;new </font><font color="#0000BB">MP3_Form</font><font color="#007700">(</font><font color="#0000BB">$variables</font><font color="#007700">, </font><font color="#0000BB">$title</font><font color="#007700">);<br /><br /></font><font color="#FF8000">/* Validate form submission. */<br /></font><font color="#007700">if (</font><font color="#0000BB">$form</font><font color="#007700">-&gt;</font><font color="#0000BB">validate</font><font color="#007700">(</font><font color="#0000BB">$variables</font><font color="#007700">)) {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* The form was submitted and had valid data. */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">require_once </font><font color="#0000BB">MOPPLE_BASE </font><font color="#007700">. </font><font color="#DD0000">'/lib/Driver.php'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$driver </font><font color="#007700">= &amp;</font><font color="#0000BB">Mopple_Driver</font><font color="#007700">::</font><font color="#0000BB">singleton</font><font color="#007700">(</font><font color="#0000BB">$conf</font><font color="#007700">[</font><font color="#DD0000">'storage'</font><font color="#007700">][</font><font color="#DD0000">'driver'</font><font color="#007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$id </font><font color="#007700">= </font><font color="#0000BB">$driver</font><font color="#007700">-&gt;</font><font color="#0000BB">add</font><font color="#007700">(</font><font color="#0000BB">$variables</font><font color="#007700">-&gt;</font><font color="#0000BB">get</font><font color="#007700">(</font><font color="#DD0000">'song_title'</font><font color="#007700">),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$variables</font><font color="#007700">-&gt;</font><font color="#0000BB">get</font><font color="#007700">(</font><font color="#DD0000">'song_artist'</font><font color="#007700">),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$variables</font><font color="#007700">-&gt;</font><font color="#0000BB">get</font><font color="#007700">(</font><font color="#DD0000">'song_album'</font><font color="#007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">is_a</font><font color="#007700">(</font><font color="#0000BB">$id</font><font color="#007700">, </font><font color="#DD0000">'PEAR_Error'</font><font color="#007700">)) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$notification</font><font color="#007700">-&gt;</font><font color="#0000BB">push</font><font color="#007700">(</font><font color="#0000BB">$id</font><font color="#007700">, </font><font color="#DD0000">'horde.error'</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;} else {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$message </font><font color="#007700">= </font><font color="#0000BB">$edit </font><font color="#007700">? </font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"The MP3 \"%s\" has been updated sucessfully."</font><font color="#007700">) :<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">_</font><font color="#007700">(</font><font color="#DD0000">"The MP3 \"%s\" has been added successfully."</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$notification</font><font color="#007700">-&gt;</font><font color="#0000BB">push</font><font color="#007700">(</font><font color="#0000BB">sprintf</font><font color="#007700">(</font><font color="#0000BB">$message</font><font color="#007700">, </font><font color="#0000BB">$variables</font><font color="#007700">-&gt;</font><font color="#0000BB">get</font><font color="#007700">(</font><font color="#DD0000">'song_title'</font><font color="#007700">)), </font><font color="#DD0000">'horde.success'</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">header</font><font color="#007700">(</font><font color="#DD0000">'Location: ' </font><font color="#007700">. </font><font color="#0000BB">Horde</font><font color="#007700">::</font><font color="#0000BB">applicationUrl</font><font color="#007700">(</font><font color="#DD0000">'list.php'</font><font color="#007700">, </font><font color="#0000BB">true</font><font color="#007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></font><font color="#FF8000">/* Output HTML. */<br /></font><font color="#007700">require </font><font color="#0000BB">MOPPLE_TEMPLATES </font><font color="#007700">. </font><font color="#DD0000">'/common-header.inc'</font><font color="#007700">;<br />require </font><font color="#0000BB">MOPPLE_TEMPLATES </font><font color="#007700">. </font><font color="#DD0000">'/menu.inc'</font><font color="#007700">;<br /></font><font color="#0000BB">$renderer </font><font color="#007700">= &amp;</font><font color="#0000BB">$form</font><font color="#007700">-&gt;</font><font color="#0000BB">getRenderer</font><font color="#007700">();<br /></font><font color="#0000BB">$form</font><font color="#007700">-&gt;</font><font color="#0000BB">renderActive</font><font color="#007700">(</font><font color="#0000BB">$renderer</font><font color="#007700">, </font><font color="#0000BB">$variables</font><font color="#007700">, </font><font color="#0000BB">Horde</font><font color="#007700">::</font><font color="#0000BB">selfUrl</font><font color="#007700">(), </font><font color="#DD0000">'post'</font><font color="#007700">);<br />require </font><font color="#0000BB">$registry</font><font color="#007700">-&gt;</font><font color="#0000BB">get</font><font color="#007700">(</font><font color="#DD0000">'templates'</font><font color="#007700">, </font><font color="#DD0000">'horde'</font><font color="#007700">) . </font><font color="#DD0000">'/common-footer.inc'</font><font color="#007700">;<br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code><br />


</td></tr></table></div>
</body>
</html>
